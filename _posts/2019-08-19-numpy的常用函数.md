---
layout: post
title: "numpy的常用函数"
date: 2019-08-19
tag: 数据分析
---

### 文件的读写

```python
# 存取TXT文件
import numpy as np
i2 = np.eye(3)  # 创建一个单位矩阵
np.savetxt("eye.txt", i2)  # 保存为TXT文件

# 这里强调的是numpy是面向浮点运算的，对于一些非浮点需要进行额外的处理，比如下面要提到的日期处理
# 处理CSV文件
# 比如下面这么一组数据，我想要处理日期和闭盘价格，这张表是data.csv
s,g = loadtxt('data.csv',delimiter=',',usecols=(0,4), skiprows=1, unpack=True,  comments='#')

# usecols表示用的是subject和grade这一列，unpack表示将不同列的数据分开存储,这里的skiprows=1表示跳过第一行，第一行一般都是跳过，从第二行开始才是我们需要处理的数据
# comment参数表示 以 # 开头的都直接省略不读
```

| date（开盘日期） | open（开盘价格） | high（当日最高价格） | low（最低价格） | close（闭盘价格） | volume（当日成交量） |
| ---------------- | ---------------- | -------------------- | --------------- | ----------------- | -------------------- |
| 2015-01-02       | 111.390          | 111.440              | 107.350         | 109.330           | 53204600.000         |
| 2015-01-05       | 108.290          | 108.650              | 105.410         | 106.250           | 64285500.000         |
| .....            | ......           | ......               | ........        | ........          | .......              |
| .....            | .......          | .......              | .........       | .........         | ........             |

<center>上图是苹果公司的股票价格走势</center>

```python
# 以下是常用的数据处理函数
# 加权平均值
np.average(x, weights=y)  # 后面是权值
# 算术平均值
np.mean(g) # 平均成绩
np.max(g) # 最大成绩
np.min(g)
np.ptp(g)  # 计算数组的差值，即 np.max(g)-np.min(g)
np.median(g)  # 中位数
np.msort(g) # 按照从小到大排序
np.var(g) # 方差
np.diff(g) # 这个函数返回由相邻数组的差值构成的数组 
np.zeros(5)  # 创建一个5个元素的数组

# where 函数会根据指定的条件返回所有满足条件的数组元素的索引值，take函数会按照索引值从数组中获取元素

a = np.array([[1, 3, 4], [2, 4, 7], [5, 2, 3]])
b = a[np.where(a[:, 0] == 2)])  # [[2 4 7]] 
np.take(b, 1)  # 这里取出来的是4

# 下面是 argmin 函数是返回 数组中最小元素的索引值，argmax是返回最大元素的索引值
np.argmin(b) 
np.argmax(b)
```

**再次强调numpy 是面向浮点运算**的，需要对日期做一些特别的处理，否则会返回 ValueError错误，我们定义一个转换函数来处理这种情况.

```python
# 字符串转日期格式
def strTodate(s):
    return datetime.datetime.strptime(s.decode('ascii'),"%d-%m-%Y").date().weekday()

s,g = loadtxt('data.csv',delimiters=',',usecols=(0,4),unpack=True, converters={5:strTodate}) # 对第五条数据进行日期转换处理
```

下面给个例子处理每个工作日的

转载请注明：[瞿晶的博客](http://fantongxue.xyz) » [点击阅读原文]([http://www.fantongxue.xyz/2019/08/numpy%E7%9A%84%E7%AE%80%E5%8D%95%E6%95%99%E7%A8%8B/](http://www.fantongxue.xyz/2019/08/numpy的简单教程/))     

